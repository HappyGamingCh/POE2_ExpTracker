<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PoE2 Experience Tracker</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Path of Exile 2 Experience Tracker</h1>
        <div class="current-progress">
            <p id="currentProgress"></p>
            <div class="progress-bar-container">
                <div id="progressBar" class="progress-bar"></div>
            </div>
        </div>
        <div class="input-section">
            <div class="character-inputs">
                <div class="input-group">
                    <label for="characterName">Character Name:</label>
                    <input type="text" id="characterName" placeholder="Enter character name">
                </div>
                <div class="input-group">
                    <label for="characterClass">Character Class:</label>
                    <select name="characterClass" id="characterClass">
                        <option value="Witch Hunter">Witch Hunter</option>
                        <option value="Gemling">Gemling</option>
                        <option value="Invoker">Invoker</option>
                        <option value="Acolyte">Acolyte</option>
                        <option value="Deadeye">Deadeye</option>
                        <option value="Pathfinder">Pathfinder</option>
                        <option value="Stormweaver">Stormweaver</option>
                        <option value="Chronomancer">Chronomancer</option>
                        <option value="Warbringer">Warbringer</option>
                        <option value="Titan">Titan</option>
                        <option value="Infernalist">Infernalist</option>
                        <option value="Blood-Mage">Blood Mage</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="currentLevel">Character Level:</label>
                    <input type="text" id="currentLevel" readonly>
                </div>
                <div class="input-group">
                    <label for="currentExp">Current Total EXP (million): <span class="required">*</span></label>
                    <input type="number" id="currentExp" step="0.01" placeholder="Enter exp in millions" required>
                </div>
                <div class="input-group">
                    <label for="nextLevelExp">Next Level Total EXP:</label>
                    <input type="text" id="nextLevelExp" readonly>
                </div>
            </div>

            <div class="map-details">
                <div class="map-details-header">
                    <h3>Map Details</h3>
                    <div class="map-type-filter">
                        <label>Filter:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" name="mapType" value="General" checked> General</label>
                            <label><input type="checkbox" name="mapType" value="Tower" checked> Tower</label>
                            <label><input type="checkbox" name="mapType" value="Hideout" checked> Hideout</label>
                            <label><input type="checkbox" name="mapType" value="Citadel" checked> Citadel</label>
                        </div>
                    </div>
                </div>
                <div class="map-input-row">
                    <div class="input-group">
                        <label for="mapName">Map Name: <span class="required">*</span></label>
                        <select id="mapName" required>
                            <option value="Abyss" data-type="General">Abyss</option>
                            <option value="Alpine Ridge" data-type="Tower">Alpine Ridge</option>
                            <option value="Augury" data-type="General">Augury</option>
                            <option value="Backwash" data-type="General">Backwash</option>
                            <option value="Blooming Field" data-type="General">Blooming Field</option>
                            <option value="Bluff" data-type="Tower">Bluff</option>
                            <option value="Burial Bog" data-type="General">Burial Bog</option>
                            <option value="Canal Hideout" data-type="Hideout">Canal Hideout</option>
                            <option value="Centotes" data-type="General">Centotes</option>
                            <option value="Copper Citadel" data-type="Citadel">Copper Citadel</option>
                            <option value="Creek" data-type="General">Creek</option>
                            <option value="Crimson Shores" data-type="General">Crimson Shores</option>
                            <option value="Crypt" data-type="General">Crypt</option>
                            <option value="Decay" data-type="General">Decay</option>
                            <option value="Deserted" data-type="General">Deserted</option>
                            <option value="Felled Hideout" data-type="Hideout">Felled Hideout</option>
                            <option value="Forge" data-type="General">Forge</option>
                            <option value="Fortress" data-type="General">Fortress</option>
                            <option value="Gothic City" data-type="General">Gothic City</option>
                            <option value="Hidden Grotto" data-type="General">Hidden Grotto</option>
                            <option value="Hive" data-type="General">Hive</option>
                            <option value="Iron Citadel" data-type="Citadel">Iron Citadel</option>
                            <option value="Limestone Hideout" data-type="Hideout">Limestone Hideout</option>
                            <option value="Lost Towers" data-type="Tower">Lost Towers</option>
                            <option value="Mesa" data-type="Tower">Mesa</option>
                            <option value="Mire" data-type="General">Mire</option>
                            <option value="Oasis" data-type="General">Oasis</option>
                            <option value="Penitentiary" data-type="General">Penitentiary</option>
                            <option value="Riverside" data-type="General">Riverside</option>
                            <option value="Rustbowl" data-type="General">Rustbowl</option>
                            <option value="Sandspit" data-type="General">Sandspit</option>
                            <option value="Savannah" data-type="General">Savannah</option>
                            <option value="Seepage" data-type="General">Seepage</option>
                            <option value="Shrine Hideout" data-type="Hideout">Shrine Hideout</option>
                            <option value="Sinking Spire" data-type="Tower">Sinking Spire</option>
                            <option value="Spider Woods" data-type="General">Spider Woods</option>
                            <option value="Steaming Springs" data-type="General">Steaming Springs</option>
                            <option value="Steppe" data-type="General">Steppe</option>
                            <option value="Stone Citadel" data-type="Citadel">Stone Citadel</option>
                            <option value="Sulphuric Caverns" data-type="General">Sulphuric Caverns</option>
                            <option value="Sump" data-type="General">Sump</option>
                            <option value="The Burning Monolith" data-type="Citadel">The Burning Monolith</option>
                            <option value="Vaal Factory" data-type="General">Vaal Factory</option>
                            <option value="Vaal Foundry" data-type="General">Vaal Foundry</option>
                            <option value="Willow" data-type="General">Willow</option>
                            <option value="Woodland" data-type="General">Woodland</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="waystoneLevel">Waystone Level:</label>
                        <select id="waystoneLevel">
                            <option value="16">16</option>
                            <option value="15" selected>15</option>
                            <option value="14">14</option>
                            <option value="13">13</option>
                            <option value="12">12</option>
                            <option value="11">11</option>
                            <option value="10">10</option>
                            <option value="9">9</option>
                            <option value="8">8</option>
                            <option value="7">7</option>
                            <option value="6">6</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                        </select>
                    </div>
                </div>
                <div class="activities-group">
                    <label>Map Activities:</label>
                    <div class="checkbox-group">
                        <label>
                            <input type="checkbox" name="activity" value="Breach">
                            <img src="https://i.imgur.com/RHaPiT7.png" alt="Breach" class="activity-icon">
                            Breach
                        </label>
                        <label>
                            <input type="checkbox" name="activity" value="Corruption">
                            <img src="https://i.imgur.com/lg23psQ.png" alt="Corruption" class="activity-icon">
                            Corruption
                        </label>
                        <label>
                            <input type="checkbox" name="activity" value="Delirium">
                            <img src="https://i.imgur.com/Ui5jlr5.png" alt="Delirium" class="activity-icon">
                            Delirium
                        </label>
                        <label>
                            <input type="checkbox" name="activity" value="Expedition">
                            <img src="https://i.imgur.com/KbMQPFo.png" alt="Expedition" class="activity-icon">
                            Expedition
                        </label>
                        <label>
                            <input type="checkbox" name="activity" value="Hideout">
                            <img src="https://i.imgur.com/etmQiga.png" alt="Hideout" class="activity-icon">
                            Hideout
                        </label>
                        <label>
                            <input type="checkbox" name="activity" value="Irradiated">
                            <img src="https://i.imgur.com/LAhc0Ri.png" alt="Irradiated" class="activity-icon">
                            Irradiated
                        </label>
                        <label>
                            <input type="checkbox" name="activity" value="Map Boss">
                            <img src="https://i.imgur.com/7kzfwJT.png" alt="Map Boss" class="activity-icon">
                            Map Boss
                        </label>
                        <label>
                            <input type="checkbox" name="activity" value="Ritual">
                            <img src="https://i.imgur.com/94RcHGe.png" alt="Ritual" class="activity-icon">
                            Ritual
                        </label>
                        <label>
                            <input type="checkbox" name="activity" value="Unique Map">
                            <img src="https://i.imgur.com/EAORWor.png" alt="Unique Map" class="activity-icon">
                            Unique Map
                        </label>
                        <label>
                            <input type="checkbox" name="activity" value="Wandering Trader">
                            <img src="https://i.imgur.com/EAORWor.png" alt="Wandering Trader" class="activity-icon">
                            Wandering Trader
                        </label>
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button onclick="recordExperience()">Record Experience</button>
                <button onclick="clearAllData()" class="clear-btn">Clear All Data</button>
            </div>
            <div id="recordSummary" class="record-summary"></div>
        </div>
        <div class="history">
            <h2>History</h2>
            <ul id="expHistory"></ul>
        </div>
        
        <div class="experience-history">
            <div class="experience-history-header">
                <h2>Experience History Graph</h2>
                <div class="experience-history-controls">
                    <select class="history-limit-select" id="historyLimit">
                        <option value="5">Last 5 entries</option>
                        <option value="10">Last 10 entries</option>
                        <option value="20">Last 20 entries</option>
                        <option value="all">All entries</option>
                    </select>
                    <button class="toggle-graph-btn" id="toggleGraphBtn">Hide Graph</button>
                </div>
            </div>
            <div id="expHistoryChart">
                <canvas></canvas>
            </div>
        </div>
        
        <div class="analysis-section">
            <h2>Analysis</h2>
            <div class="analysis-summary">
                <div class="summary-header">
                    <h3>Summary</h3>
                    <button id="shareButton" onclick="shareAnalysis()">
                        <i class="fas fa-share-alt"></i>
                        Share
                    </button>
                </div>
                <div class="summary-grid">
                    <div class="summary-item">
                        <span class="summary-label">Average EXP per Map:</span>
                        <span id="avgExpPerMap">-</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Maps to Next Level:</span>
                        <span id="mapsToLevel">-</span>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Best Maps for EXP:</span>
                        <div id="bestMaps">-</div>
                    </div>
                    <div class="summary-item">
                        <span class="summary-label">Best Activities for EXP:</span>
                        <div id="bestActivities">-</div>
                    </div>
                </div>
            </div>
            <div class="analysis-container">
                <div class="analysis-group">
                    <h3>Map Analysis</h3>
                    <div class="analysis-charts">
                        <div class="analysis-box">
                            <h4>Average Experience by Map</h4>
                            <canvas id="mapExpAnalysisChart"></canvas>
                        </div>
                        <div class="analysis-box doughnut-chart">
                            <h4>Map Run Frequency</h4>
                            <canvas id="mapFreqAnalysisChart"></canvas>
                        </div>
                    </div>
                </div>
                <div class="analysis-group">
                    <h3>Activity Analysis</h3>
                    <div class="analysis-charts">
                        <div class="analysis-box">
                            <h4>Average Experience by Activity</h4>
                            <canvas id="activityExpAnalysisChart"></canvas>
                        </div>
                        <div class="analysis-box doughnut-chart">
                            <h4>Activity Frequency</h4>
                            <canvas id="activityFreqAnalysisChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <footer class="footer">
            <div class="visitor-count">
                <div class="visitor-badge">
                    <img src="https://visitor-badge.laobi.icu/badge?page_id=HappyGamingCh.POE2_ExpTracker&color=e7c491&labelColor=2d1810" alt="visitor count">
                </div>
            </div>
            <div class="donate">
                <p>Support this project simply by subscribing to my YouTube channel. Thank you!</p>
                <a href="https://www.youtube.com/@pednoi55?sub_confirmation=1" class="donate-button" target="_blank">Subscribe</a>
            </div>
            <div class="copyright">
                © 2024 PoE2 Experience Tracker. All rights reserved.
            </div>
        </footer>
    </div>
    <div class="share-modal" id="shareModal">
        <div class="share-modal-content">
            <button class="share-modal-close" onclick="closeShareModal()">×</button>
            <img id="shareImage" alt="Analysis Share Image">
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>
